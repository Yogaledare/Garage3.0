@model IEnumerable<Garage3._0.Models.ViewModels.VehicleViewModel>

<table class="table table-sm mb-0">
    <thead>
    <tr class="bg-secondary text-white">
    @* <tr> *@
        <th>License Plate</th>
        <th>Vehicle Type</th>
        <th>Parking Start Time</th>
        <th>Parking End Time</th>
        <th>Parked Time</th>
        <th style="width: 200px;">Actions</th>
    </tr>
    </thead>
    <tbody>
    @foreach (var vehicle in Model) {
        var parkingStartDisplay = vehicle.ParkingStartedDateTime.HasValue
            ? vehicle.ParkingStartedDateTime.Value.ToString("yyyy-MM-dd HH:mm")
            : "N/A";
        var parkingEndDisplay = vehicle.ParkingEndedDateTime.HasValue
            ? vehicle.ParkingEndedDateTime.Value.ToString("yyyy-MM-dd HH:mm")
            : "N/A";

        // Determine whether the vehicle is currently parked
        var isParked = vehicle.ParkingStartedDateTime.HasValue && !vehicle.ParkingEndedDateTime.HasValue;

        <tr class="bg-light">
        @* <tr> *@
            <td>@vehicle.LicensePlate</td>
            <td>@vehicle.VehicleTypeName</td>
            <td>@parkingStartDisplay</td>
            <td>@parkingEndDisplay</td>
            <td>@vehicle.ParkedTime.TotalHours.ToString("F2") hours</td>
            <td class="d-flex justify-content-center">
                @if (isParked) {
                    <form asp-action="Logout" asp-controller="Register" method="post">
                        <input type="hidden" name="id" value="@vehicle.VehicleId"/>
                        <button type="submit" class="btn btn-danger">Unpark</button>
                    </form>
                }
                else {
                    <form asp-action="Login" asp-controller="Register" method="post">
                        <input type="hidden" name="id" value="@vehicle.VehicleId"/>
                        <button type="submit" class="btn btn-success">Park</button>
                    </form>
                }
            </td>
        </tr>
    }
    </tbody>
</table>